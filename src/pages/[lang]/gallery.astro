---
// Layout
import Layout from '../../layouts/Layout.astro'

// Sections
import GallerySwipper from '../../components/sections/base/GallerySwipper.tsx'

// Libs
import { useTranslations } from '../../i18n/utils'
import { getStaticPathsLangs } from '../../libs/getStaticPaths'
import clsx from 'clsx'

// i18n
export const getStaticPaths = getStaticPathsLangs
const { lang } = Astro.params as any
const t = useTranslations(lang)

// Get all images from gallery subdirectories
const allImages = import.meta.glob('/public/gallery/**/*.{jpg,jpeg,png,webp}', {
  eager: true,
  as: 'url',
})

// Filter images by categories
const categories = ['transports', 'transports2', 'transports3']
const categoriesImages = categories.map((category) => {
  const images = Object.values(allImages).filter(imagePath => {
    return imagePath.includes(`/gallery/${category}/`)
  })
  return {
    categoryName: category,
    images,
  }
})
---

<Layout>
  {
    categoriesImages.map((category) => {
      return (
        <section
          id={category.categoryName}
          class={clsx('container', 'w-full', 'px-0', '!my-12')}
        >
          <GallerySwipper 
            client:load
            title={category.categoryName}
            images={category.images}
          />
        </section>
      )
    })
  }
</Layout>
